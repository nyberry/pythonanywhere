{% extends "dinner/layout.html" %}
{% load static %}

{% block title %}
    Result
{% endblock %}

{% block main %}
    <br>
    <h1>{{ guesser.name }} guessed that {{ guessed_player.name }}'s answer is {{ guessed_answer }}.</h1>
    <br><br>
    {% if correct %}
        <h1>This is CORRECT</h1>
    {% else %}
        <h1>But it is NOT</h1>
    {% endif %}
    <br>

    <!-- Use a button instead of an anchor -->
    <button id="viewResultsBtn" class="standard-button">OK</button>
    
    {% if  current_player.has_viewed_result %}
        <h3> Waiting for the other guests </h3>

        <br>
        <div class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <br>
    {% endif %}

    <script>
        document.getElementById('viewResultsBtn').addEventListener('click', function() {
            // Create a form element
            var form = document.createElement('form');

            // Set form attributes (action and method)
            form.setAttribute('action', "{% url 'view_result' game.pk %}");
            form.setAttribute('method', 'POST');

            // Create a hidden input field for CSRF token
            var csrfToken = document.createElement('input');
            csrfToken.setAttribute('type', 'hidden');
            csrfToken.setAttribute('name', 'csrfmiddlewaretoken');
            csrfToken.setAttribute('value', '{{ csrf_token }}');
            form.appendChild(csrfToken);

            // Submit the form
            document.body.appendChild(form);
            form.submit();
        });
    </script>

{% endblock %}